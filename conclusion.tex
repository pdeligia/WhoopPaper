In this paper, we present \whoop, a new fully automatic approach for (i) finding data races in device drivers and (ii) accelerating bug-finding using race-related information. In the heart of our approach, we combine static lockset analysis with sound sequentialization and automated theorem proving. Our lockset analysis enforces the locking discipline that two threads accessing the same shared resource must hold at least one common lock, and reports a potential data race if this discipline is violated.

Compared to traditional data race detection tools that typically attempt to explore as many thread interleavings as feasible, and thus face scalability issues in the presence of realistic concurrent programs, \textsc{Whoop} not only entirely avoids reasoning about thread interleavings, but also allows the reuse of existing successful sequential verification techniques. The main limitation of our approach is that it can potentially report many false positives, as we over-approximate the device driver shared state. To tackle this problem, we use the race-related information that \whoop generates to speed up \corral, a state-of-the-art precise bug-finder for concurrent programs.